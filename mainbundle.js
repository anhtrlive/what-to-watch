!function(e){function t(t){for(var r,n,l=t[0],o=t[1],c=t[2],d=0,u=[];d<l.length;d++)n=l[d],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&u.push(s[n][0]),s[n]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(m&&m(t);u.length;)u.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,l=1;l<a.length;l++){var o=a[l];0!==s[o]&&(r=!1)}r&&(i.splice(t--,1),e=n(n.s=a[0]))}return e}var r={},s={0:0},i=[];function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=r,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://anhtrlive.github.io/what-to-watch";var l=window.webpackJsonp=window.webpackJsonp||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var m=o;i.push([60,1]),a()}({59:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var r=a(13),s=a.n(r),i=a(0),n=a.n(i),l=a(5),o=a(11),c=a(30),m=a(2),d=a(1),u=a.n(d);class h extends i.PureComponent{constructor(e){super(e),this._videoRef=n.a.createRef()}render(){const{movieName:e,img:t,previewVideoLink:a,handleCardMouseEnter:r,handleCardonMouseLeave:s}=this.props;let i=e.toLowerCase().split(" ").join("-");return n.a.createElement("article",{className:"small-movie-card catalog__movies-card",onMouseOver:r,onMouseLeave:s},n.a.createElement(m.b,{to:`/${i}/overview`,className:"small-movie-card__link"},n.a.createElement("div",{className:"small-movie-card__image"},n.a.createElement("video",{width:"280",height:"175",muted:!0,style:{objectFit:"fill"},ref:this._videoRef,src:a,poster:t})),n.a.createElement("h3",{className:"small-movie-card__title"},e)))}componentDidUpdate(){const e=this._videoRef.current;this.props.isPlaying?e.play():e.load()}componentWillUnmount(){let e=this._videoRef.current;e.src="",e.poster="",e=null}}function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}h.propTypes={movieName:u.a.string.isRequired,img:u.a.string.isRequired,previewVideoLink:u.a.string.isRequired,isPlaying:u.a.bool.isRequired,handleCardMouseEnter:u.a.func.isRequired,handleCardonMouseLeave:u.a.func.isRequired};const p=(e=>{class t extends i.PureComponent{constructor(e){super(e),this.state={activePlayer:!1},this.timerId=null,this._handleCardMouseEnter=this._handleCardMouseEnter.bind(this),this._handleCardonMouseLeave=this._handleCardonMouseLeave.bind(this)}_handleCardMouseEnter(){this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.setState({activePlayer:!0})},1e3)}_handleCardonMouseLeave(){this.timerId&&clearTimeout(this.timerId),!1!==this.state&&this.setState({activePlayer:!1})}render(){const{activePlayer:t}=this.state;return n.a.createElement(e,_({},this.props,{isPlaying:t,handleCardMouseEnter:this._handleCardMouseEnter,handleCardonMouseLeave:this._handleCardonMouseLeave}))}componentDidUpdate(){clearTimeout(this.timerId)}componentWillUnmount(){clearTimeout(this.timerId)}}return t})(h);class v extends i.PureComponent{constructor(e){super(e)}render(){let{movies:e,genre:t}=this.props;return n.a.createElement("div",{className:"catalog__movies-list"},e.map((e,a)=>n.a.createElement(p,{key:(t+e.id+a).toString(),movieName:e.name,img:e.previewImage,genre:t,previewVideoLink:e.previewVideoLink})))}}v.propTypes={movies:u.a.array.isRequired,genre:u.a.string};class g extends i.PureComponent{constructor(e){super(e)}render(){const{genre:e,films:t,clickHandlerGenre:a,resetShowCard:r}=this.props;let s=new Set(t.map(e=>e.genre));return s=[...s.keys()],s.sort(),s=["All genres",...s],n.a.createElement("ul",{className:"catalog__genres-list"},s.map((t,s)=>{const i=e===t?"catalog__genres-item catalog__genres-item--active":"catalog__genres-item";return n.a.createElement("li",{className:i,onClick:e=>{a(e),r()},key:`${t}-${s}`},n.a.createElement("a",{href:"#a",className:"catalog__genres-link"},t))}))}}g.propTypes={genre:u.a.string.isRequired,films:u.a.array.isRequired,clickHandlerGenre:u.a.func.isRequired,resetShowCard:u.a.func.isRequired};class E extends i.PureComponent{constructor(e){super(e)}render(){const{films:e,genre:t,movies:a,showMore:r}=this.props,s=e.filter(e=>e.genre===t||"All genres"===t).length===a.length?"catalog__more visually-hidden":"catalog__more";return n.a.createElement("div",{className:s},n.a.createElement("button",{className:"catalog__button",type:"button",onClick:()=>r(a.length)},"Show more"))}}E.propTypes={genre:u.a.string.isRequired,films:u.a.array.isRequired,movies:u.a.array.isRequired,showMore:u.a.func.isRequired};class f{constructor(e){this.id=e.id,this.name=e.name,this.posterImage=e.poster_image,this.previewImage=e.preview_image,this.backgroundImage=e.background_image,this.backgroundColor=e.background_color,this.videoLink=e.video_link,this.previewVideoLink=e.preview_video_link,this.description=e.description,this.rating=e.rating,this.scoresCount=e.scores_count,this.director=e.director,this.starrings=e.starring,this.runTime=e.run_time,this.genre=e.genre,this.released=e.released,this.isFavorite=e.is_favorite}static parseFilm(e){return new f(e)}static parseFilms(e){return e.map(f.parseFilm)}}const b={genre:"All genres",films:[],movies:[],showcard:8,isAutorized:!1,user:null,bookmarks:[],comments:[]},y={loadComments:e=>async(t,a,r)=>{const s=await r.get("/comments/"+e);t(N.loadComments(s.data))},loadFavoriteMovies:()=>async(e,t,a)=>{const r=await a.get("/favorite");e(N.loadFavoriteMovies(r.data))},addReview:(e,t)=>async(a,r,s)=>{const i=await s.post("/comments/"+e,t);a(N.loadComments(i.data))},switchFavorite:(e,t)=>async(a,r,s)=>{await s.post(`/favorite/${e}/${t}`),a(y.loadFavoriteMovies())},loadData:()=>async(e,t,a)=>{const r=await a.get("/films");e(N.loadData(r.data))},autorized:(e,t)=>async(a,r,s)=>{const i={email:e,password:t},n=await s.post("/login",i);return 200===n.status&&(a(N.loginCheck(n.data)),a(N.checkautorized(!0)),a(y.loadFavoriteMovies())),n.status},checkautorized:()=>async(e,t,a)=>{const r=await a.get("/login");try{if(200!==r.status)throw e(N.checkautorized(!1)),new Error(r.status);e(N.loginCheck(r.data)),e(N.checkautorized(!0)),e(y.loadFavoriteMovies())}catch(e){return e}return r.status}},N={addMyList:e=>({type:"ADD_TO_BOOKMARKS",payload:e}),loadComments:e=>({type:"LOAD_COMMENTS",payload:e}),loadFavoriteMovies:e=>({type:"LOAD_FAVORITE_MOVIES",payload:e.map(e=>e.name)}),showMore:e=>({type:"ADD_MORE_CARDS_MOVIES",payload:(e=>e+20)(e)}),resetShowCard:()=>({type:"RESET_NUMBER_OF_SHOW_CARD",payload:8}),loadData:e=>({type:"LOAD_DATA",payload:e}),loginCheck:e=>({type:"AUTHORIZED",payload:e}),checkautorized:e=>({type:"CHECKAUTORIEZED",payload:e})},R=(e=b,t)=>{switch(t.type){case"FILTER_MOVIES_BY_GANRE":return Object.assign({},e,{movies:t.payload});case"ADD_MORE_CARDS_MOVIES":return Object.assign({},e,{showcard:t.payload});case"LOAD_DATA":return Object.assign({},e,{films:f.parseFilms(t.payload)});case"LOAD_COMMENTS":return Object.assign({},e,{comments:t.payload});case"LOAD_FAVORITE_MOVIES":return Object.assign({},e,{bookmarks:t.payload});case"CHECKAUTORIEZED":return Object.assign({},e,{isAutorized:t.payload});case"AUTHORIZED":return Object.assign({},e,{user:t.payload});case"RESET_NUMBER_OF_SHOW_CARD":return Object.assign({},e,{showcard:t.payload});default:return e}};var w=a(31);const k=Object(w.a)(e=>e.films,(e,t)=>t,e=>e.showcard,(e,t,a)=>("All genres"===t?e:e.filter(e=>e.genre===t)).slice(0,a)),C=(e,t)=>{const a=({isAutorized:a,...r})=>a?n.a.createElement(t,r):n.a.createElement(e,r);return a.propTypes={isAutorized:u.a.bool.isRequired},a};class M extends i.PureComponent{constructor(e){super(e),this._checkIsFavorite=this._checkIsFavorite.bind(this)}_checkIsFavorite(){const{name:e,bookmarks:t}=this.props;return t.some(t=>t===e)?0:1}render(){const{movieId:e,switchFavorite:t}=this.props;return n.a.createElement("button",{className:"btn btn--list movie-card__button",type:"button",onClick:()=>{t(e,this._checkIsFavorite())}},this._checkIsFavorite()?n.a.createElement("svg",{viewBox:"0 0 19 20",width:19,height:20},n.a.createElement("use",{xlinkHref:"#add"})):n.a.createElement("svg",{viewBox:"0 0 18 14",width:"18",height:"14"},n.a.createElement("use",{xlinkHref:"#in-list"})),n.a.createElement("span",null,"My list"))}}M.propTypes={bookmarks:u.a.array.isRequired,movieId:u.a.number.isRequired,name:u.a.string.isRequired,switchFavorite:u.a.func.isRequired};var T=Object(l.b)((e,t)=>Object.assign({},t,{bookmarks:e.bookmarks}),e=>({switchFavorite:(t,a)=>{e(y.switchFavorite(t,a))}}))(M);var O=()=>n.a.createElement(m.b,{to:"/login",className:"btn btn--list movie-card__button"},n.a.createElement("svg",{viewBox:"0 0 19 20",width:19,height:20},n.a.createElement("use",{xlinkHref:"#add"})),n.a.createElement("span",null,"My list"));const S=e=>{const{pathName:t}=e;return n.a.createElement(m.b,{to:`/${t}/play`,className:"btn btn--play movie-card__button",type:"button"},n.a.createElement("svg",{viewBox:"0 0 19 19",width:19,height:19},n.a.createElement("use",{xlinkHref:"#play-s"})),n.a.createElement("span",null,"Play"))};S.propTypes={pathName:u.a.string.isRequired};var x=S;const L=C(O,T);class q extends i.PureComponent{constructor(e){super(e)}radnomNumber(e){return Math.floor(Math.random()*(e-1))}render(){const{isAutorized:e}=this.props;void 0===sessionStorage.randomNum&&window.sessionStorage.setItem("randomNum",this.radnomNumber(this.props.films.length));const{name:t,genre:a,posterImage:r,released:s,backgroundImage:i,id:l}=this.props.films[Number(window.sessionStorage.getItem("randomNum"))];let o=t.toLowerCase().split(" ").join("-");return n.a.createElement("div",{className:"movie-card__wrap"},n.a.createElement("div",{className:"movie-card__bg"},n.a.createElement("img",{src:i,alt:t})),n.a.createElement("div",{className:"movie-card__info"},n.a.createElement(m.b,{to:`/${o}/overview`,className:"movie-card__poster"},n.a.createElement("img",{src:r,alt:t,width:218,height:327})),n.a.createElement("div",{className:"movie-card__desc"},n.a.createElement("h2",{className:"movie-card__title"},t),n.a.createElement("p",{className:"movie-card__meta"},n.a.createElement("span",{className:"movie-card__genre"},a),n.a.createElement("span",{className:"movie-card__year"},s)),n.a.createElement("div",{className:"movie-card__buttons"},n.a.createElement(x,{pathName:o}),n.a.createElement(L,{movieId:l,isAutorized:e,name:t})))))}}function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}q.propTypes={films:u.a.array.isRequired,isAutorized:u.a.bool.isRequired};var I=()=>n.a.createElement("footer",{className:"page-footer"},n.a.createElement("div",{className:"logo"},n.a.createElement(m.b,{to:"/",className:"logo__link logo__link--light"},n.a.createElement("span",{className:"logo__letter logo__letter--1"},"W"),n.a.createElement("span",{className:"logo__letter logo__letter--2"},"T"),n.a.createElement("span",{className:"logo__letter logo__letter--3"},"W"))),n.a.createElement("div",{className:"copyright"},n.a.createElement("p",null,"Â© 2019 What to watch Ltd.")));var V=()=>n.a.createElement("div",{className:"logo"},n.a.createElement(m.b,{to:"/",className:"logo__link"},n.a.createElement("span",{className:"logo__letter logo__letter--1"},"W"),n.a.createElement("span",{className:"logo__letter logo__letter--2"},"T"),n.a.createElement("span",{className:"logo__letter logo__letter--3"},"W"))),H=a.p+"e66208e6468c08ed6bb1db4621050c9d.jpg";var P=()=>n.a.createElement(m.b,{to:"/my-list",className:"user-block"},n.a.createElement("div",{className:"user-block__avatar"},n.a.createElement("img",{src:H,alt:"User avatar",width:63,height:63})));const j=e=>{let{films:t,genre:a,movies:r,clickHandlerGenre:s,showMore:l,isAutorized:o,resetShowCard:c}=e;return n.a.createElement(i.Fragment,null,((e,t,a,r,s,l,o)=>{const c=n.a.createElement(P,null),d=n.a.createElement("div",{className:"user-block"},n.a.createElement(m.b,{to:"/login",className:"user-block__link"},"Sign in")),u=l?c:d;return n.a.createElement(i.Fragment,null,n.a.createElement("section",{className:"movie-card"},n.a.createElement("h1",{className:"visually-hidden"},"WTW"),n.a.createElement("header",{className:"page-header movie-card__head"},n.a.createElement(V,null),u),e.length?n.a.createElement(q,{films:e,isAutorized:l}):n.a.createElement(i.Fragment,null)),n.a.createElement("div",{className:"page-content"},n.a.createElement("section",{className:"catalog"},n.a.createElement("h2",{className:"catalog__title visually-hidden"},"Catalog"),n.a.createElement(g,{genre:t,films:e,clickHandlerGenre:r,resetShowCard:o}),n.a.createElement(v,{movies:a,genre:t}),n.a.createElement(E,{films:e,genre:t,movies:a,showMore:s})),n.a.createElement(I,null)))})(t,a,r,s,l,o,c))};j.propTypes={clickHandlerGenre:u.a.func.isRequired,films:u.a.array.isRequired,genre:u.a.string.isRequired,isAutorized:u.a.bool.isRequired,movies:u.a.array.isRequired,resetShowCard:u.a.func.isRequired,showMore:u.a.func.isRequired};var F=(e=>{class t extends i.PureComponent{constructor(e){super(e),this.state={genre:"All genres"},this._clickHandlerGenre=this._clickHandlerGenre.bind(this)}_clickHandlerGenre(e){e.preventDefault(),this.setState({genre:e.target.textContent})}render(){const{genre:t}=this.state;return n.a.createElement(e,A({},this.props,{genre:t,clickHandlerGenre:this._clickHandlerGenre}))}}return t})(Object(l.b)((e,t)=>{const{genre:a}=t;return Object.assign({},t,{movies:k(e,a),isAutorized:e.isAutorized})},e=>({showMore:t=>{e(N.showMore(t))},resetShowCard:()=>{e(N.resetShowCard())}}))(j)),z=a(4);class D extends i.PureComponent{constructor(e){super(e),this.state={email:"",password:""},this._handleChangeEmail=this._handleChangeEmail.bind(this),this._handleChangePassword=this._handleChangePassword.bind(this)}_handleChangeEmail(e){this.setState({email:e.target.value})}_handleChangePassword(e){this.setState({password:e.target.value})}render(){let{isAutorized:e,autorized:t,history:a}=this.props;return e?n.a.createElement(z.a,{to:"/"}):n.a.createElement("div",{className:"user-page"},n.a.createElement("header",{className:"page-header user-page__head"},n.a.createElement(V,null),n.a.createElement("h1",{className:"page-title user-page__title"},"Sign in")),n.a.createElement("div",{className:"sign-in user-page__content"},n.a.createElement("form",{action:"#",className:"sign-in__form",onSubmit:e=>{e.preventDefault(),this.state.email.length>5&&this.state.password.length>7&&(t(this.state.email,this.state.password),a.goBack())}},n.a.createElement("div",{className:"sign-in__fields"},n.a.createElement("div",{className:"sign-in__field"},n.a.createElement("input",{className:"sign-in__input",type:"email",pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$",placeholder:"Email address",name:"user-email",id:"user-email",autoComplete:"username",onChange:this._handleChangeEmail,minLength:"6"}),n.a.createElement("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email"},"Email address")),n.a.createElement("div",{className:"sign-in__field"},n.a.createElement("input",{className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password",autoComplete:"current-password",onChange:this._handleChangePassword,minLength:"8"}),n.a.createElement("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password"},"Password"))),n.a.createElement("div",{className:"sign-in__submit"},n.a.createElement("button",{className:"sign-in__btn",type:"submit"},"Sign in")))),n.a.createElement(I,null))}}D.propTypes={autorized:u.a.func.isRequired,history:u.a.shape({goBack:u.a.func.isRequired}),isAutorized:u.a.bool.isRequired};var U=Object(z.g)(Object(l.b)((e,t)=>Object.assign({},t,{isAutorized:e.isAutorized}),e=>({autorized:(t,a)=>{e(y.autorized(t,a))}}))(D));const W=e=>{const{activeTab:t}=e;return n.a.createElement("nav",{className:"movie-nav movie-card__nav"},n.a.createElement("ul",{className:"movie-nav__list"},["Overview","Details","Review"].map((e,a)=>{const r=e.toLowerCase()===t?"movie-nav__item movie-nav__item--active":"movie-nav__item";return n.a.createElement("li",{className:r,key:(e+a).toString(),style:{cursor:"pointer"}},n.a.createElement(m.b,{to:e.toLowerCase(),className:"movie-nav__link"},e))})))};W.propTypes={activeTab:u.a.string.isRequired};const B=e=>{const{starrings:t,runTime:a,genre:r,released:s,director:i}=e;return n.a.createElement("div",{className:"movie-card__text movie-card__row"},n.a.createElement("div",{className:"movie-card__text-col"},n.a.createElement("p",{className:"movie-card__details-item"},n.a.createElement("strong",{className:"movie-card__details-name"},"Director"),n.a.createElement("span",{className:"movie-card__details-value"},i)),n.a.createElement("p",{className:"movie-card__details-item"},n.a.createElement("strong",{className:"movie-card__details-name"},"Starring"),n.a.createElement("span",{className:"movie-card__details-value"},t.map((e,t)=>n.a.createElement("span",{key:(e+t).toString()},e,n.a.createElement("br",null)))))),n.a.createElement("div",{className:"movie-card__text-col"},n.a.createElement("p",{className:"movie-card__details-item"},n.a.createElement("strong",{className:"movie-card__details-name"},"Run Time"),n.a.createElement("span",{className:"movie-card__details-value"},a)),n.a.createElement("p",{className:"movie-card__details-item"},n.a.createElement("strong",{className:"movie-card__details-name"},"Genre"),n.a.createElement("span",{className:"movie-card__details-value"},r)),n.a.createElement("p",{className:"movie-card__details-item"},n.a.createElement("strong",{className:"movie-card__details-name"},"Released"),n.a.createElement("span",{className:"movie-card__details-value"},s))))};B.propTypes={starrings:u.a.array.isRequired,runTime:u.a.number.isRequired,genre:u.a.string.isRequired,released:u.a.number.isRequired,director:u.a.string.isRequired};const G=e=>{const{stringRaiting:t,rating:a,description:r,director:s,starrings:i,scoresCount:l}=e;return n.a.createElement("section",null,n.a.createElement("div",{className:"movie-rating"},n.a.createElement("div",{className:"movie-rating__score"},a),n.a.createElement("p",{className:"movie-rating__meta"},n.a.createElement("span",{className:"movie-rating__level"},t),n.a.createElement("span",{className:"movie-rating__count"},l," ratings"))),n.a.createElement("div",{className:"movie-card__text"},n.a.createElement("p",null,r),n.a.createElement("p",{className:"movie-card__director"},n.a.createElement("strong",null,"Director: ",s)),n.a.createElement("p",{className:"movie-card__starring"},n.a.createElement("strong",null,"Starring: ",i.join(", ")," and other"))))};G.propTypes={stringRaiting:u.a.string.isRequired,rating:u.a.number.isRequired,description:u.a.string.isRequired,director:u.a.string.isRequired,starrings:u.a.array.isRequired,scoresCount:u.a.number.isRequired};const $=e=>{let{comments:t}=e;return n.a.createElement("div",{className:"movie-card__reviews movie-card__row"},n.a.createElement("div",{className:"movie-card__reviews-col"},t.map(e=>{let t={year:"numeric",month:"long",day:"numeric"},{rating:a,comment:r,date:s,user:i}=e,l=new Date(s).toLocaleDateString("en-EN",t);return n.a.createElement("div",{className:"review",key:s+i.id},n.a.createElement("blockquote",{className:"review__quote"},n.a.createElement("p",{className:"review__text"},r),n.a.createElement("footer",{className:"review__details"},n.a.createElement("cite",{className:"review__author"},i.name),n.a.createElement("time",{className:"review__date",dateTime:"2016-12-24"},l))),n.a.createElement("div",{className:"review__rating"},a))})))};$.propTypes={comments:u.a.array.isRequired};var K=Object(l.b)((e,t)=>Object.assign({},t,{comments:e.comments}),null)($);const Z=C(O,T),J=e=>{const{name:t,genre:a,released:r,isAutorized:s,movieId:i}=e;let l;return t&&(l=t.toLowerCase().split(" ").join("-")),n.a.createElement("div",{className:"movie-card__wrap"},n.a.createElement("div",{className:"movie-card__desc"},n.a.createElement("h2",{className:"movie-card__title"},t),n.a.createElement("p",{className:"movie-card__meta"},n.a.createElement("span",{className:"movie-card__genre"},a),n.a.createElement("span",{className:"movie-card__year"},r)),n.a.createElement("div",{className:"movie-card__buttons"},n.a.createElement(x,{pathName:l}),n.a.createElement(Z,{movieId:i,isAutorized:s,name:t}),n.a.createElement(m.b,{to:`/${l}/add-review`,className:"btn movie-card__button"},"Add review"))))};J.propTypes={name:u.a.string.isRequired,genre:u.a.string.isRequired,released:u.a.number.isRequired,isAutorized:u.a.bool.isRequired,movieId:u.a.number.isRequired};var X=J;const Y=e=>{const{films:t,name:a,genre:r,released:s,isAutorized:l,movieId:o,backgroundImage:c}=e;return n.a.createElement("div",{className:"movie-card__hero"},n.a.createElement("div",{className:"movie-card__bg"},n.a.createElement("img",{src:c,alt:a})),n.a.createElement("h1",{className:"visually-hidden"},"WTW"),n.a.createElement("header",{className:"page-header movie-card__head"},n.a.createElement(V,null),l?n.a.createElement(P,null):n.a.createElement("div",{className:"user-block"},n.a.createElement(m.b,{to:"/login",className:"user-block__link"},"Sign in"))),t.length>0?n.a.createElement(X,{name:a,genre:r,released:s,isAutorized:l,movieId:o}):n.a.createElement(i.Fragment,null))};Y.propTypes={backgroundImage:u.a.string,films:u.a.array,genre:u.a.string,isAutorized:u.a.bool.isRequired,movieId:u.a.number,name:u.a.string,released:u.a.number};var Q=Y;const ee=e=>{const{genre:t,moreLikeThis:a}=e;return n.a.createElement("div",{className:"page-content"},n.a.createElement("section",{className:"catalog catalog--like-this"},n.a.createElement("h2",{className:"catalog__title"},"More like this"),n.a.createElement(v,{movies:a,genre:t})),n.a.createElement(I,null))};ee.propTypes={genre:u.a.string,moreLikeThis:u.a.array};var te=ee;const ae=((e,t,a)=>{const r=({activeTab:r,...s})=>"overview"===r?n.a.createElement(e,s):"details"===r?n.a.createElement(t,s):"review"===r?n.a.createElement(a,s):n.a.createElement(z.a,{to:"/page-not-found"});return r.propTypes={activeTab:u.a.string.isRequired},r})(G,B,K);class re extends i.PureComponent{constructor(e){super(e)}render(){const{films:e,isAutorized:t,pathMovieName:a,activeTab:r,loadComments:s}=this.props;let l,o=[],c=[];if(0!==e.length){if(l=a.toLowerCase().split("-").join(" "),o=e.filter(e=>e.name.toLowerCase()===l)[0],void 0===o)return n.a.createElement(z.a,{to:"/page-not-found"});s(o.id),c=e.filter(e=>e.genre===o.genre&&e.name!==o.name),c=function(e){for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e}(c).sort((e,t)=>t.id-e.id).slice(0,4)}const{name:m,rating:d,description:u,director:h,starrings:_,runTime:p,genre:v,released:g,scoresCount:E,backgroundImage:f,posterImage:b,backgroundColor:y,id:N}=o,R=["bad","normal","good"][Math.floor(d/4)];return n.a.createElement(i.Fragment,null,n.a.createElement("section",{className:"movie-card movie-card--full",style:{background:""+y}},n.a.createElement(Q,{films:e,name:m,genre:v,released:g,isAutorized:t,movieId:N,backgroundImage:f}),n.a.createElement("div",{className:"movie-card__wrap movie-card__translate-top"},n.a.createElement("div",{className:"movie-card__info"},n.a.createElement("div",{className:"movie-card__poster movie-card__poster--big"},n.a.createElement("img",{src:b,alt:m,width:"218",height:"327"})),n.a.createElement("div",{className:"movie-card__desc"},n.a.createElement(W,{activeTab:r}),e.length>0?n.a.createElement(ae,{activeTab:r,stringRaiting:R,rating:d,description:u,director:h,starrings:_,scoresCount:E,runTime:p,genre:v,released:g,id:N}):n.a.createElement(i.Fragment,null))))),n.a.createElement(te,{moreLikeThis:c,genre:v}))}}re.propTypes={activeTab:u.a.string.isRequired,films:u.a.array.isRequired,isAutorized:u.a.bool.isRequired,loadComments:u.a.func.isRequired,pathMovieName:u.a.string.isRequired};var se=Object(l.b)((e,t)=>Object.assign({},t,{films:e.films,isAutorized:e.isAutorized}),e=>({loadComments:t=>{e(y.loadComments(t))}}))(re);class ie extends i.PureComponent{constructor(e){super(e),this.state={playing:!1,fullscreen:!1,duraTionTime:-1,runTime:.001,volume:1},this._videoRef=n.a.createRef(),this._progressRef=n.a.createRef(),this._playerRef=n.a.createRef(),this._controlPanelRef=n.a.createRef(),this._exitLinkRef=n.a.createRef(),this._volumeRef=n.a.createRef(),this._progressVolumeRef=n.a.createRef(),this._volimeTogglerRef=n.a.createRef(),this.timerId=-1,this.timerHodeControlPanel=-1,this.volumePrevState=0,this._playPauseCLickHandler=this._playPauseCLickHandler.bind(this),this._fullScreenVideo=this._fullScreenVideo.bind(this),this._fullScreenVideoKeyHandler=this._fullScreenVideoKeyHandler.bind(this),this._setTime=this._setTime.bind(this),this._sec2time=this._sec2time.bind(this),this._slide=this._slide.bind(this),this._flag=!0,this._sliderAddEventListener=this._sliderAddEventListener.bind(this),this._sliderMouseUpHadnler=this._sliderMouseUpHadnler.bind(this),this._hideControlPanelOnMouseMove=this._hideControlPanelOnMouseMove.bind(this),this._volumeHandler=this._volumeHandler.bind(this),this._showVolumeValue=this._showVolumeValue.bind(this),this._hideVolumeValue=this._hideVolumeValue.bind(this),this._slideVolume=this._slideVolume.bind(this),this._slideVolemeHandler=this._slideVolemeHandler.bind(this)}_slide(e){e.preventDefault();const t=this._videoRef.current,a=this._progressRef.current;let r=isNaN(t.duration)?this.state.runTime:t.duration,s=(e.clientX-25)/a.offsetWidth*100;s=Math.min(99.9,s),s=Math.max(0,s),t.currentTime=s/100*r,this.setState(()=>({duraTionTime:+(t.duration-t.currentTime).toFixed(3)}))}_slideVolume(e){e.preventDefault();const t=this._videoRef.current;let a=this._progressVolumeRef.current.getBoundingClientRect(),r=(e.clientX-a.x-7)/a.width*100;r=Math.min(99.9,r),r=Math.max(0,r),t.volume=r/100,this.setState(()=>({volume:t.volume}))}_playPauseCLickHandler(e){e.preventDefault(),e.stopPropagation(),document.removeEventListener("mouseup",this.sliderMouseUpHadnler),this.setState(e=>({playing:!e.playing}))}_volumeHandler(e){if(77===e.keyCode||"fas"===e.target.classList[0]){const e=this._videoRef.current,t=this.volumePrevState;this.volumePrevState=this.state.volume,this.setState(a=>0===a.volume?(e.volume=t,{volume:t}):(e.volume=0,{volume:0}))}}_fullScreenVideo(e){if(27===e.target.parentElement.clientWidth||27===e.target.clientWidth){document.removeEventListener("mouseup",this.sliderMouseUpHadnler);const e=this._videoRef.current;!1===this.state.fullscreen&&e.parentElement.webkitRequestFullscreen(),!0===this.state.fullscreen&&document.webkitExitFullscreen()}}_fullScreenVideoKeyHandler(e){if("player__video"===e.target.className||70===e.keyCode){document.removeEventListener("mouseup",this.sliderMouseUpHadnler);const e=this._videoRef.current;!1===this.state.fullscreen&&e.parentElement.webkitRequestFullscreen(),!0===this.state.fullscreen&&document.webkitExitFullscreen()}}_setTime(e){-1===this.timerId&&(this.timerId=setInterval(()=>{let t=isNaN(e.duration)?this.state.runTime:e.duration;this.setState(()=>({duraTionTime:+(t-e.currentTime).toFixed(3)}))},50))}_reset(e){if(this.state.playing){const t=this._controlPanelRef.current,a=this._playerRef.current,r=this._exitLinkRef.current;t.style="opacity:1; transition:opacity 0.2s linear;*",r.style="opacity:1; transition:opacity 0.2s linear;*",a.style="cursor: auto",clearInterval(this.timerId),this.timerId=-1,e.load(),this.setState({playing:!1,duraTionTime:this.state.runTime})}}_sec2time(e){if(0===(e=+e.toFixed(3)))return"00:00";const t=(e,t)=>("00"+e).slice(-1*t);let a=parseFloat(e).toFixed(3),r=Math.floor(a/60/60),s=Math.floor(a/60)%60,i=Math.floor(a-60*s);return 0===r?t(s,2)+":"+t(i,2):t(r,2)+":"+t(s,2)+":"+t(i,2)}_hideControlPanelOnMouseMove(){if(this.state.playing){const e=this._controlPanelRef.current,t=this._exitLinkRef.current,a=this._playerRef.current;a.style="cursor: auto",e.style="opacity:1; transition:opacity 0.2s linear;*",t.style="opacity:1; transition:opacity 0.2s linear;*",clearTimeout(this.timerHodeControlPanel);let r=()=>{this.state.playing&&(a.style="cursor: none",e.style="opacity:0; transition:opacity 0.2s linear;*",t.style="opacity:0; transition:opacity 0.2s linear;*")};r=r.bind(this),this.timerHodeControlPanel=setTimeout(r,3e3)}}_showVolumeValue(){this._volumeRef.current.classList.add("volume-active")}_hideVolumeValue(){this._slideVolemeHandler(),this._volumeRef.current.classList.remove("volume-active")}render(){const{films:e,pathMovieName:t}=this.props;let a,r=[];if(0!==e.length&&(a=t.toLowerCase().split("-").join(" "),r=e.filter(e=>e.name.toLowerCase()===a)[0],void 0===r))return n.a.createElement(z.a,{to:"/page-not-found"});const{videoLink:s,previewImage:i,name:l}=r,o=i,c=s,d=this.state.playing?"#pause":"#play-s";let u=-1===this.state.duraTionTime?this.state.runTime:this.state.duraTionTime;u=isNaN(u)?this.state.runTime:u;const h=100*(1-u/this.state.runTime),_=100*this.state.volume,p=this._sec2time(this.state.runTime-u),v=this._sec2time(this.state.runTime);return n.a.createElement("div",{className:"player",ref:this._playerRef,onKeyDown:e=>{this._fullScreenVideoKeyHandler(e),this._volumeHandler(e)},onMouseMove:this._hideControlPanelOnMouseMove,onClick:this._hideControlPanelOnMouseMove,onDoubleClick:this._fullScreenVideoKeyHandler,tabIndex:"0"},n.a.createElement("video",{ref:this._videoRef,className:"player__video",src:c,poster:o}),n.a.createElement(m.b,{to:e=>{const t=e.pathname.split("/").slice(0,2).join("/");return{location:e,pathname:t+"/overview"}},className:"player__exit",ref:this._exitLinkRef},"Exit"),n.a.createElement("div",{className:"player__controls",ref:this._controlPanelRef},n.a.createElement("div",{className:"player__controls-row"},n.a.createElement("div",{className:"player__time"},n.a.createElement("progress",{className:"player__progress",value:h,max:"100",ref:this._progressRef,onMouseDown:e=>{this._slide(e),this._sliderAddEventListener(e)}}),n.a.createElement("div",{className:"player__toggler",style:{left:h+"%"},onMouseDown:e=>{this._slide(e),this._sliderAddEventListener(e)}},"Toggler")),n.a.createElement("div",{className:"player__time-value",style:{width:"85px"}},`${p} / ${v}`)),n.a.createElement("div",{className:"player__controls-row"},n.a.createElement("button",{type:"button",className:"player__play",onClick:this._playPauseCLickHandler},n.a.createElement("svg",{viewBox:"0 0 19 19",width:"19",height:"19"},n.a.createElement("use",{xlinkHref:d})),n.a.createElement("span",null,"Play")),n.a.createElement("div",{id:"fashover",onMouseEnter:this._showVolumeValue,onMouseLeave:this._hideVolumeValue},this.state.volume?n.a.createElement("i",{className:"fas fa-volume-up",onClick:this._volumeHandler}):n.a.createElement("i",{className:"fas fa-volume-mute",onClick:this._volumeHandler})),n.a.createElement("div",{className:"volume__value",ref:this._volumeRef,onMouseLeave:this._hideVolumeValue,onMouseEnter:this._showVolumeValue},n.a.createElement("progress",{className:"volume__progress",ref:this._progressVolumeRef,value:_,max:"100",onMouseDown:e=>{this._slideVolume(e);this._volimeTogglerRef.current.addEventListener("mousemove",this._slideVolume)},onMouseUp:this._slideVolemeHandler}),n.a.createElement("div",{className:"volume__toggler",ref:this._volimeTogglerRef,style:{left:_+"px"},onMouseDown:e=>{this._slideVolume(e),e.target.addEventListener("mousemove",this._slideVolume)},onMouseUp:this._slideVolemeHandler},"Toggler")),n.a.createElement("div",{className:"player__name"},l),n.a.createElement("button",{type:"button",className:"player__full-screen",onClick:this._fullScreenVideo},n.a.createElement("svg",{viewBox:"0 0 27 27",width:"27",height:"27"},n.a.createElement("use",{xlinkHref:"#full-screen"})),n.a.createElement("span",null,"Full screen")))))}_slideVolemeHandler(){const e=this._progressVolumeRef.current,t=this._volimeTogglerRef.current;e.removeEventListener("mousemove",this._slideVolume),t.removeEventListener("mousemove",this._slideVolume)}_sliderMouseUpHadnler(e,t){const a=this._playerRef.current;e.stopPropagation(),a.removeEventListener("mousemove",this._slide),this.setState(()=>({playing:t})),document.removeEventListener("mouseup",this.mouseUpHandler)}_sliderAddEventListener(){const e=this.state.playing;this._playerRef.current.addEventListener("mousemove",this._slide),this.setState(()=>({playing:!1})),this.mouseUpHandler=t=>{this._sliderMouseUpHadnler(t,e)},this.mouseUpHandler=this.mouseUpHandler.bind(this),document.addEventListener("mouseup",this.mouseUpHandler)}componentDidMount(){const e=this._videoRef.current;e.onloadedmetadata=()=>{this.setState(()=>({runTime:e.duration}))},e.parentElement.onwebkitfullscreenchange=()=>{this.setState(e=>({fullscreen:!e.fullscreen}))}}componentDidUpdate(e,t){const a=this._videoRef.current;a&&(a.muted=this.state.muted,!0===a.paused&&this.state.playing&&this._setTime(a),this.state.playing&&!1===t.playing&&a.play(),this.state.playing&&a.currentTime===this.state.runTime&&this._reset(a),!1===this.state.playing&&(clearInterval(this.timerId),this.timerId=-1,a.pause()))}componentWillUnmount(){let e=this._videoRef.current;if(e){const t=this._playerRef.current;clearInterval(this.timerId),e.src="",e.poster="",e=null,document.removeEventListener("mouseup",this.sliderMouseUpHadnler),t.removeEventListener("mousemove",this._slide)}}}ie.propTypes={films:u.a.array.isRequired,pathMovieName:u.a.string.isRequired};var ne=Object(l.b)((e,t)=>Object.assign({},t,{films:e.films}))(ie);const le=e=>{let{bookmarks:t,films:a,isAutorized:r}=e;return a&&(a=a.filter(e=>t.some(t=>t===e.name))),r?n.a.createElement("div",{className:"user-page"},n.a.createElement("header",{className:"page-header user-page__head"},n.a.createElement(V,null),n.a.createElement("h1",{className:"page-title user-page__title"},"My list"),n.a.createElement(P,null)),n.a.createElement("section",{className:"catalog"},n.a.createElement("h2",{className:"catalog__title visually-hidden"},"Catalog"),n.a.createElement(v,{movies:a,genre:"my-list"})),n.a.createElement(I,null)):n.a.createElement(z.a,{to:"/login"})};le.propTypes={bookmarks:u.a.array.isRequired,films:u.a.array.isRequired,isAutorized:u.a.bool.isRequired};var oe=Object(l.b)((e,t)=>Object.assign({},t,{bookmarks:e.bookmarks,films:e.films,isAutorized:e.isAutorized}),e=>({loadFavoriteMovies:()=>{e(y.loadFavoriteMovies())}}))(le);class ce extends i.PureComponent{constructor(e){super(e),this.state={rating:5,comment:""},this._textareaRef=n.a.createRef(),this._showErrorRef=n.a.createRef(),this._changeRaiting=this._changeRaiting.bind(this),this._changeText=this._changeText.bind(this)}_changeRaiting(e){this.setState({rating:+e.target.value})}_changeText(e){this.setState({comment:e.target.value})}render(){let{films:e,pathMovieName:t,addReview:a,isAutorized:r,history:s}=this.props;if(!r)return n.a.createElement(z.a,{to:"/login"});let i=[];e.length>0&&e.forEach(e=>{e.name.toLowerCase().split(" ").join("-")===t&&(i=e)});let{name:l,posterImage:o,backgroundImage:c,backgroundColor:d,id:u}=i;const h=n.a.createElement(P,null),_=n.a.createElement("div",{className:"user-block"},n.a.createElement(m.b,{to:"/login",className:"user-block__link"},"Sign in")),p=r?h:_;return n.a.createElement("section",{className:"movie-card movie-card--full",style:{background:""+d}},n.a.createElement("div",{className:"movie-card__header"},n.a.createElement("div",{className:"movie-card__bg"},n.a.createElement("img",{src:c,alt:l})),n.a.createElement("h1",{className:"visually-hidden"},"WTW"),n.a.createElement("header",{className:"page-header"},n.a.createElement(V,null),n.a.createElement("nav",{className:"breadcrumbs"},n.a.createElement("ul",{className:"breadcrumbs__list"},n.a.createElement("li",{className:"breadcrumbs__item"},n.a.createElement(m.b,{to:`/${t}/overview`,className:"breadcrumbs__link"},l)),n.a.createElement("li",{className:"breadcrumbs__item"},n.a.createElement("a",{className:"breadcrumbs__link"},"Add review")))),p),n.a.createElement("div",{className:"movie-card__poster movie-card__poster--small"},n.a.createElement("img",{src:o,alt:"The Grand Budapest Hotel poster",width:"218",height:"327"}))),n.a.createElement("div",{className:"add-review"},n.a.createElement("form",{action:"#",className:"add-review__form"},n.a.createElement("div",{className:"rating"},n.a.createElement("div",{className:"rating__stars"},n.a.createElement("input",{className:"rating__input",id:"star-1",onChange:this._changeRaiting,type:"radio",name:"rating",value:"1"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-1"},"Rating 1"),n.a.createElement("input",{className:"rating__input",id:"star-2",onChange:this._changeRaiting,type:"radio",name:"rating",value:"2"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-2"},"Rating 2"),n.a.createElement("input",{className:"rating__input",id:"star-3",onChange:this._changeRaiting,type:"radio",name:"rating",value:"3"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-3"},"Rating 3"),n.a.createElement("input",{className:"rating__input",id:"star-4",onChange:this._changeRaiting,type:"radio",name:"rating",value:"4"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-4"},"Rating 4"),n.a.createElement("input",{className:"rating__input",id:"star-5",onChange:this._changeRaiting,type:"radio",name:"rating",value:"5",defaultChecked:!0}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-5"},"Rating 5"),n.a.createElement("input",{className:"rating__input",id:"star-6",onChange:this._changeRaiting,type:"radio",name:"rating",value:"6"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-6"},"Rating 6"),n.a.createElement("input",{className:"rating__input",id:"star-7",onChange:this._changeRaiting,type:"radio",name:"rating",value:"7"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-7"},"Rating 7"),n.a.createElement("input",{className:"rating__input",id:"star-8",onChange:this._changeRaiting,type:"radio",name:"rating",value:"8"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-8"},"Rating 8"),n.a.createElement("input",{className:"rating__input",id:"star-9",onChange:this._changeRaiting,type:"radio",name:"rating",value:"9"}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-9"},"Rating 9"),n.a.createElement("input",{className:"rating__input",id:"star-10",onChange:this._changeRaiting,type:"radio",name:"rating",value:"10",defaultChecked:!0}),n.a.createElement("label",{className:"rating__label",htmlFor:"star-10"},"Rating 10"))),n.a.createElement("div",{className:"validationBlock",ref:this._showErrorRef},n.a.createElement("div",{className:"validationMassage"},"Text is too short(minimum is 50 characters)"),n.a.createElement("div",{id:"triangleValidation"})),n.a.createElement("div",{className:"add-review__text"},n.a.createElement("textarea",{className:"add-review__textarea",ref:this._textareaRef,minLength:"50",maxLength:"400",onChange:e=>{this._changeText(e),this.state.comment.length>=50&&this._showErrorRef.current.classList.remove("showValidationMassage")},name:"review-text",id:"review-text",placeholder:"Review text"}),n.a.createElement("div",{className:"add-review__submit"},n.a.createElement("button",{className:"add-review__btn",onClick:e=>{e.preventDefault();let r=this._textareaRef.current.value.length;r>=50&&r<=400?(a(u,this.state),s.push(`/${t}/review`)):this._showErrorRef.current.classList.add("showValidationMassage")}},"Post"))))))}}ce.propTypes={addReview:u.a.func,films:u.a.array.isRequired,history:u.a.object.isRequired,isAutorized:u.a.bool.isRequired,pathMovieName:u.a.string.isRequired};var me=Object(z.g)(Object(l.b)((e,t)=>Object.assign({},t,{isAutorized:e.isAutorized}),e=>({addReview:(t,a)=>{e(y.addReview(t,a))}}))(ce));var de=()=>n.a.createElement("div",{className:"page-not-found"},n.a.createElement("p",null,"HTTP:",n.a.createElement("span",null,"404")),n.a.createElement("center",null,n.a.createElement(m.b,{to:"/"},"HOME")));class ue extends i.PureComponent{constructor(e){super(e),this.state={couter:0}}render(){let{films:e,resetShowCard:t}=this.props;return n.a.createElement(z.d,null,n.a.createElement(z.b,{path:"/",exact:!0,render:()=>(t(),n.a.createElement(F,{films:e,genre:"All genres"}))}),n.a.createElement(z.b,{path:"/login",exact:!0,component:U}),n.a.createElement(z.b,{path:"/my-list",exact:!0,component:oe}),n.a.createElement(z.b,{path:"/:pathMovieName/play",exact:!0,render:({match:e})=>{const{pathMovieName:t}=e.params;return n.a.createElement(ne,{pathMovieName:t})}}),n.a.createElement(z.b,{path:"/:pathMovieName/add-review",exact:!0,render:({match:t})=>{const{pathMovieName:a}=t.params;return n.a.createElement(me,{pathMovieName:a,films:e})}}),n.a.createElement(z.b,{path:"/:pathMovieName/:activeTab",render:({match:e})=>{const{pathMovieName:t,activeTab:a}=e.params;return n.a.createElement(se,{pathMovieName:t,activeTab:a})}}),n.a.createElement(z.b,{component:de}))}}ue.propTypes={films:u.a.array.isRequired,resetShowCard:u.a.func.isRequired};var he=Object(l.b)((e,t)=>Object.assign({},t,{films:e.films}),e=>({resetShowCard:()=>{e(N.resetShowCard())}}))(ue),_e=a(32),pe=a.n(_e);a(59);(()=>{const e=(()=>{const e=pe.a.create({baseURL:"https://htmlacademy-react-3.appspot.com/wtw",timeout:5e3,withCredentials:!0});return e.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status?e.response.status:Promise.reject(e)})),e})(),t=Object(o.d)(R,Object(o.c)(Object(o.a)(c.a.withExtraArgument(e))));t.dispatch(y.loadData()),t.dispatch(y.checkautorized()),s.a.render(n.a.createElement(l.a,{store:t},n.a.createElement(m.a,{basename:"/what-to-watch"},n.a.createElement(he,null))),document.querySelector("#root"))})()}});